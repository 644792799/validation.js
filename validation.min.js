/**
 * @author Matt Hinchliffe <http://www.maketea.co.uk>
 * @version 0.9.8
 * @modified 07/03/2011
 */

var Validation={init:function(a,c,d){this.options={error_node:d.error_node||"p",error_class:d.error_class||"form_error",error_display:d.error_display!==false,error_message:d.error_message||"The given value is invalid.",error_placement:d.error_placement||"after"};if(!(this.form=document.getElementById(a))||typeof c!=="object"){return null}this.model=c;var b=this;this.bind(function(h){b.form_valid=true;b.errors=b.valid={};for(var e in b.model){var k;if(!(k=document.getElementById(e))){break}var j=b.get_value(k);b.clear_error_message(e);for(var l in b.model[e]){var f,g,i=b.model[e][l];if(l!="error"){if(typeof b[l]!=="function"){break}if(Array.isArray){g=Array.isArray(i)}else{g=(Object.prototype.toString.call(i)==="[object Array]")}if(g){f=i[i.length-1]||b.options.error_message}else{f=b.model[e]["error"]||b.options.error_message;i=[i]}if(b[l].apply(b,[j].concat(i))===false){b.form_valid=b.valid[e]=false;b.create_error_message(k,f);break}}}}h.returnValue=b.form_valid;if(!b.form_valid&&h.preventDefault){h.preventDefault()}})},bind:function(a){if(this.form.addEventListener){this.form.addEventListener("submit",a,false)}else{this.form.attachEvent("onsubmit",a)}},get_value:function(b){var a;if(b.nodeName.toLowerCase()=="input"){a=b.getAttribute("type")}if(a&&(a=="checkbox"||a=="radio")){return b.checked?true:false}else{return b.value!==undefined?b.value:false}},create_error_message:function(d,b){this.errors[d.id]=b;if(!b||!this.options.error_display){return}var a=d.parentNode,f=document.createTextNode(b),e=document.createElement(this.options.error_node);e.setAttribute("id","error__"+d.id);e.className=this.options.error_class;e.appendChild(f);if(this.options.error_placement=="before"){var c=a.firstChild;a.insertBefore(e,c)}else{a.appendChild(e)}},clear_error_message:function(b){var a=document.getElementById("error__"+b);if(a){a.parentNode.removeChild(a)}},present:function(c,b){var a;if(typeof c=="boolean"){a=c}else{if(!c){a=false}else{a=!!(c.length>0)}}return(b)?a:!a},expressions:{alphanumeric:/^([a-z0-9_\-])$/,number:/^([0-9])+$/,text:/^(^[a-z])+$/,email:/^([a-z0-9_\.\-]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/,url:/^(https?:\/\/)?([\da-z\.\-]+)\.([a-z\.]{2,6})([\/\w \.\-]*)*\/?$/,date:/^(([0-3][0-9]|[1-9])[\/\-\.]([0-1][0-9]|[1-9])[\/\-\.]([0-9][0-9])?[0-9][0-9])$/,time:/^(([0-2])?[0-9]:[0-5][0-9])$/},test:function(b,a){if(!this.present(b,true)){return null}if(this.expressions[a]){return !!(this.expressions[a]).test(b.toString())}else{return false}},valid_date:function(d,c,g){var f,a,e,b;if(!this.present(d,true)){return null}d=d.split(g||"-").join(",");if(!(f=d.match(/^(\d{1,2})[,](\d{1,2})[,](\d{2,4})$/))){return false}a=parseInt(c?f[2]:f[1]);e=parseInt(c?f[1]:f[2]);b=parseInt(f[3].length==2?"20"+f[3]:f[3]);if(a<1||a>31||e<1||e>12||b<1900||b>2100){return false}else{if(a>30&&e in {4:"",6:"",9:"",11:""}){return false}else{if(e==2&&!(a<=28||(a==29&&(b%4==0&&(b%100!=0||b%400==0))))){return false}}}return true},minimum_length:function(a,b){if(!this.present(a,true)){return null}return !!(a.length>=b)},maximum_length:function(a,b){if(!this.present(a,true)){return null}return !!(a.length<=b)},greater_than:function(a,b){if(!this.present(a,true)){return null}return !!(parseInt(a,10)>=b)},less_than:function(a,b){if(!this.present(a,true)){return null}return !!(parseInt(a,10)<=b)},match:function(c,b){var d=document.getElementById(b),a=d?this.get_value(d):null;return !!(c===a)}};function Validate(a,c,d){d|={};var b=Object.create(Validation);b.init(a,c,d);return b}if(typeof Object.create!=="function"){Object.create=function(b){function a(){}a.prototype=b;return new a()}};